import{l as o}from"./log.js";const i=()=>{o("initAutoUpdater"),(async()=>{const r=await fetch("./.timestamp").then(e=>e.json());for(;;){o("checking for updates...");const e=await fetch("./.timestamp").then(n=>n.json()).catch(()=>"unknown");if(e==="unknown"||e===r)await new Promise(n=>setTimeout(n,1e3));else{o(`new update found! ${new Date(r)} -> ${new Date(e)}`),chrome.runtime.reload();return}}})()};o("init");chrome.storage.local.get(["is-first-run"],t=>{if(t["is-first-run"]===void 0){o("first run, opening first-run.html"),chrome.storage.local.set({"is-first-run":!0}),chrome.tabs.create({url:chrome.runtime.getURL("first-run.html")});return}o("not first run, skipping first-run.html")});i();chrome.runtime.onMessage.addListener(function(t,r){var e,n;return t.type==="action:update-badge"&&(t.text&&chrome.action.setBadgeText({text:t.text,tabId:(e=r.tab)==null?void 0:e.id}),t.color&&chrome.action.setBadgeBackgroundColor({color:t.color,tabId:(n=r.tab)==null?void 0:n.id})),!0});
//# sourceMappingURL=background.js.map
